
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../05_construct_basics/">
      
      
        <link rel="next" href="../07_kaitai_next_steps/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.7">
    
    
      
        <title>6. Creating Example Data - Custom data format</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.046329b4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#objectives" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Custom data format" class="md-header__button md-logo" aria-label="Custom data format" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Custom data format
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6. Creating Example Data
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Custom data format" class="md-nav__button md-logo" aria-label="Custom data format" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Custom data format
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../00_index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../01_introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../02_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Setup
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../03_filetype/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. File types
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../04_kaitai_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Kaitai basics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../05_construct_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Construct basics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    6. Creating Example Data
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    6. Creating Example Data
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objectives" class="md-nav__link">
    Objectives:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-creating-example-data" class="md-nav__link">
    6: Creating Example Data
  </a>
  
    <nav class="md-nav" aria-label="6: Creating Example Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-designing-the-data-structure" class="md-nav__link">
    6.1: Designing the Data Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-preparing-your-environment" class="md-nav__link">
    6.2: Preparing Your Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-creating-and-visualizing-the-data" class="md-nav__link">
    6.3: Creating and Visualizing the Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-saving-data-as-binary" class="md-nav__link">
    6.4: Saving Data as Binary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../07_kaitai_next_steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Kaitai Next Steps
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../08_construct_next_steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. Construct Next Steps
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../09_conclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. Conclusion
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../10_appendix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Appendix
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objectives" class="md-nav__link">
    Objectives:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-creating-example-data" class="md-nav__link">
    6: Creating Example Data
  </a>
  
    <nav class="md-nav" aria-label="6: Creating Example Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-designing-the-data-structure" class="md-nav__link">
    6.1: Designing the Data Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-preparing-your-environment" class="md-nav__link">
    6.2: Preparing Your Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-creating-and-visualizing-the-data" class="md-nav__link">
    6.3: Creating and Visualizing the Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-saving-data-as-binary" class="md-nav__link">
    6.4: Saving Data as Binary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h3 id="objectives">Objectives:</h3>
<ul>
<li>Create example data to practice using Kaitai and Construct.</li>
</ul>
<h1 id="6-creating-example-data">6: Creating Example Data</h1>
<p>Now that you understand the basics of file formats and parsing tools, let's put everything together by generating some example data, saving it in a binary file, and preparing to describe its structure with Kaitai and Construct. This hands-on section will help you see how real binary data is created and organized.</p>
<p>Suppose we want to simulate a waveform and store it in a binary file. For demonstration, imagine we're measuring vibrations or current intensity. Since we're fabricating data, the context is flexible.</p>
<p>We'll use Python for this example, as it's required for Construct. If you haven't set up your Python environment yet, see the <a href="../02_setup/">setup section (2.2)</a> for instructions.</p>
<h2 id="61-designing-the-data-structure">6.1: Designing the Data Structure</h2>
<p>Let's divide our data into three sections based on intensity:
- <strong>Full data:</strong> The entire waveform.
- <strong>Mid-range data:</strong> Only points where the signal is moderate.
- <strong>Peak data:</strong> Only the most intense points.</p>
<p>This could represent three sensors with different sensitivities.</p>
<h2 id="62-preparing-your-environment">6.2: Preparing Your Environment</h2>
<p>You'll need the following Python libraries:
- <code>numpy</code> (for numerical arrays)
- <code>struct</code> (for binary packing; different from Construct)
- <code>matplotlib</code> (optional, for plotting)</p>
<p>To check if these are installed, run:</p>
<pre><code>pip list
</code></pre>
<p>If you don't see <code>numpy</code> or <code>matplotlib</code>, install them with:</p>
<pre><code>pip install numpy
pip install matplotlib
</code></pre>
<blockquote>
<p><strong>Note:</strong> There is no package called <code>python_struct</code>; <code>struct</code> is part of the Python standard library.</p>
</blockquote>
<h2 id="63-creating-and-visualizing-the-data">6.3: Creating and Visualizing the Data</h2>
<p>Create a new <code>.py</code> or <code>.ipynb</code> file (e.g., <code>example_data.py</code>). You can also reference the <a href="https://github.com/det-lab/lessons-data-format/blob/gh-pages/examples/example_data.ipynb">example notebook</a>.</p>
<p>Import the necessary modules:</p>
<pre><code class="language-python">import numpy as np
import struct
import matplotlib.pyplot as plt
</code></pre>
<p>Now, initialize arrays for each section:</p>
<pre><code class="language-python">full_x, full_y = [], []
mid_x, mid_y = [], []
peak_x, peak_y = [], []
</code></pre>
<p>Populate these arrays with simulated data. For example, generate 100,000 points from <code>x = -5</code> to <code>x = 5</code> using the (totally arbitrary) equation <span class="arithmatex">\(y=cos(\frac{2 \pi x^2}{x^2 +x})sin(x)\)</span>:</p>
<pre><code class="language-python">for x in np.arange(-5, 5, 0.0001):
    y = (np.cos((2 * np.pi * x**2)/(x**2 + x))) * np.sin(x)
    full_x.append(x)
    full_y.append(y)
    if y**2 &lt; 0.3:
        mid_x.append(x)
        mid_y.append(y)
    if y**2 &gt; 0.65:
        peak_x.append(x)
        peak_y.append(y)
</code></pre>
<p>You can then visualize the data:</p>
<pre><code class="language-python">plt.plot(full_x, full_y)
plt.title(&quot;Full Data&quot;)
plt.show()

plt.plot(mid_x, mid_y)
plt.title(&quot;Mid-range Data&quot;)
plt.show()

plt.scatter(peak_x, peak_y, s=1)
plt.title(&quot;Peak Data&quot;)
plt.show()
</code></pre>
<p>The resulting graphs should look like:</p>
<p><img alt="full" src="../examples/full-graph.png" />
<img alt="mid" src="../examples/mid-graph.png" />
<img alt="peak" src="../examples/peak-graph.png" /></p>
<h2 id="64-saving-data-as-binary">6.4: Saving Data as Binary</h2>
<p>Convert your lists to numpy arrays with a specific data type (e.g., <code>float32</code> for 4 bytes per value):</p>
<pre><code class="language-python">full_x_data = np.array(full_x, dtype=np.float32)
full_y_data = np.array(full_y, dtype=np.float32)
mid_x_data = np.array(mid_x, dtype=np.float32)
mid_y_data = np.array(mid_y, dtype=np.float32)
peak_x_data = np.array(peak_x, dtype=np.float32)
peak_y_data = np.array(peak_y, dtype=np.float32)
</code></pre>
<blockquote>
<p>You can experiment with other types like <code>float64</code>, <code>float16</code>, or even integer types if you wish.</p>
</blockquote>
<p>When saving binary data, it's helpful to include the length of each section at the start of the file or near the front of its respective section. This makes parsing easier later. </p>
<pre><code class="language-python">with open('wave_data.test', 'wb') as f:
    # Write array lengths as unsigned 4-byte integers
    f.write(struct.pack('I', len(full_y_data)))
    f.write(struct.pack('I', len(mid_y_data)))
    f.write(struct.pack('I', len(peak_y_data)))
    # Write all arrays in order
    full_x_data.tofile(f)
    full_y_data.tofile(f)

    mid_x_data.tofile(f)
    mid_y_data.tofile(f)

    peak_x_data.tofile(f)
    peak_y_data.tofile(f)
</code></pre>
<p>You now have a binary file called <code>wave_data.test</code> in your working directory. The file extension is arbitrary; modern systems do not require three-letter extensions.</p>
<hr />
<p>Continue to <a href="../07_kaitai_next_steps/">Kaitai Next Steps</a> to describe and parse your custom data with Kaitai Struct.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>